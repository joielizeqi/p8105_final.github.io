<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Cumulative impact of various factors on dog bite incidents</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<link href="site_libs/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-5.3.1/bootstrap.bundle.min.js"></script>
<script src="site_libs/bs3compat-0.8.0/transition.js"></script>
<script src="site_libs/bs3compat-0.8.0/tabs.js"></script>
<script src="site_libs/bs3compat-0.8.0/bs3compat.js"></script>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="report.html">Report</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="team.html">Team</a>
    </li>
    <li>
      <a href="datasource.html">Data source</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="eda.html">Exploratory Data Analysis</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="trends.html">Dog bite incidence trends</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Bite-to-license spatial correlation</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="distribution.html">Spatial distribution on NYC map</a>
        </li>
        <li>
          <a href="correlation.html">Spatial correlation using Moran's I</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="regression.html">Modeling dog bite incidences</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://zhenkunnfang.shinyapps.io/shiny_app-1/">Shiny App</a>
</li>
<li>
  <a href="https://www.youtube.com/">
    <span class="fa fa-youtube-play"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/joielizeqi/p8105_final.github.io.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Cumulative impact of various factors on dog
bite incidents</h1>

</div>


<div id="variable-features" class="section level1">
<h1>Variable features</h1>
<p>The dependent variable hypothesized in the article is the number of
dog bite incidents per zipcode. The predictor variables include the year
and month of the incident, characteristics of the dog, and the area
where the incident occurred. The year is measured as an interval-level
variable, with values from 1 (corresponding to 2015) to 7 (corresponding
to 2021). The area of the incident is divided into variables ranging
from 1 to 5, representing the five boroughs of New York City. The gender
of the dog is a binary variable, with 1 indicating female and 2
indicating male. Similarly, the sterilization status of the dog is also
a binary variable, with 0 indicating unsterilized and 1 indicating
sterilized.</p>
<pre class="r"><code>data &lt;- data.frame(
  `Variable` = c(&quot;dog_bite_incidents&quot;, &quot;year&quot;, &quot;month&quot;, &quot;gender&quot;, &quot;spay_neuter&quot;, &quot;borough&quot;),
  `Range` = c(
    &quot;$\\mathbb{N}$&quot;,
    &quot;$\\{1, 2, 3, 4, 5, 6, 7\\}$&quot;,
    &quot;$\\{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12\\}$&quot;,
    &quot;$\\{1, 2\\}$&quot;,
    &quot;$\\{0, 1\\}$&quot;,
    &quot;$\\{1, 2, 3, 4, 5\\}$&quot;
  )
)

knitr::kable(data, format = &quot;pipe&quot;, align = &quot;l&quot;, caption = &quot;Variable Implications&quot;)</code></pre>
<table>
<caption>Variable Implications</caption>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dog_bite_incidents</td>
<td align="left"><span class="math inline">\(\mathbb{N}\)</span></td>
</tr>
<tr class="even">
<td align="left">year</td>
<td align="left"><span class="math inline">\(\{1, 2, 3, 4, 5, 6,
7\}\)</span></td>
</tr>
<tr class="odd">
<td align="left">month</td>
<td align="left"><span class="math inline">\(\{1, 2, 3, 4, 5, 6, 7, 8,
9, 10, 11, 12\}\)</span></td>
</tr>
<tr class="even">
<td align="left">gender</td>
<td align="left"><span class="math inline">\(\{1, 2\}\)</span></td>
</tr>
<tr class="odd">
<td align="left">spay_neuter</td>
<td align="left"><span class="math inline">\(\{0, 1\}\)</span></td>
</tr>
<tr class="even">
<td align="left">borough</td>
<td align="left"><span class="math inline">\(\{1, 2, 3, 4,
5\}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="negative-binomial-regression-analysis" class="section level1">
<h1>Negative Binomial Regression Analysis</h1>
<p>To measure the combined effects of year, dog background
characteristics (i.e., gender and whether neutered) and the Borough they
belong to on the incidence of dog bites, we first conduct a negative
binomial regression analysis using records of dog bite incidents in New
York.</p>
<p>The negative binomial regression model is a type of count model
designed for dependent variables that can only take non-negative integer
values. From the Spatial Correlations section, the study area meets the
three prerequisites for negative binomial regression: the dog bite
incidents are not independent, exhibiting spatial clustering; the
dependent variable shows overdispersion; and the frequency of dog bite
incidents is sufficiently low. Let the dependent variable follows a
negative binomial distribution. The model equation is as follows:</p>
<p><span class="math display">\[\ln ({\hat y_i}) = {\beta _0} + {\beta
_1}{X_{i1}} + {\beta _2}{X_{i2}} +  \cdots {\beta _m}{X_{im}} +
\xi\]</span></p>
<p>Here, <span class="math inline">\({y_i}\)</span> represents the
frequency of dog bite incidents within a year, <span
class="math inline">\({\beta _m}\)</span> is the coefficient, <span
class="math inline">\(X_m\)</span> are the explanatory variables, and
<span class="math inline">\(\xi\)</span> represents the heterogeneity
across observations.</p>
<p>In negative binomial regression, where the conditional expectation
<span class="math inline">\(E(Y|X) = {e^{{\beta _0} + {\beta _1}{X_{i1}}
+ {\beta _2}{X_{i2}} +  \cdots {\beta _m}{X_{im}}}}\)</span>, the
interpretation of the model’s coefficients is as follows: when the
explanatory variable <span class="math inline">\({X_k}\)</span>
increases by one unit, the average occurrence rate of dog bite incidents
becomes <span class="math inline">\({e^{{\beta _k}}}\)</span> times what
it was originally.</p>
<p><span class="math display">\[\frac{{E(Y|{X^*})}}{{E(Y|X)}} =
\frac{{{e^{{\beta _0} + {\beta _1}{X_{i1}} +  \cdots  + {\beta
_k}({X_{ik}} + 1) +  \cdots  + {\beta _m}{X_{im}}}}}}{{{e^{{\beta _0} +
{\beta _1}{X_{i1}} +  \cdots  + {\beta _k}{X_{ik}} +  \cdots  + {\beta
_m}{X_{im}}}}}} = {e^{{\beta _k}}}\]</span></p>
<div id="regularized-model-lasso" class="section level2">
<h2>Regularized Model (Lasso)</h2>
<p>Initially, the paper employs Lasso regression on five primary
variables, aiming to use regularization to reduce the number of
variables in the model and thus avoid overfitting.</p>
<pre class="r"><code># lasso
library(glmnet)

x = model.matrix(bite_count ~ year + month + gender + spay_neuter + borough, data = bites_by_group)
y = bites_by_group |&gt; pull(bite_count)

cv_model = cv.glmnet(x, y, family = &quot;poisson&quot;, alpha = 1)  # Lasso：alpha = 1

cv_results &lt;- with(cv_model, 
  data.frame(
  log_lambda = log(lambda),
  mean_mse = cvm,
  lower_mse = cvlo,
  upper_mse = cvup
))

best_lambda &lt;- cv_model$lambda.min
log_best_lambda &lt;- log(best_lambda)</code></pre>
<p><span class="math inline">\(\lambda\)</span> is the regularization
parameter in Lasso regression, controlling variable selection and the
sparsity of the model. Finding the optimal <span
class="math inline">\(\lambda\)</span> value is crucial as it balances
model complexity and predictive performance. The ideal <span
class="math inline">\(\lambda\)</span> value, derived from
cross-validation, minimizes model error. For this study, the optimal
<span class="math inline">\(\lambda\)</span> has been determined to be
0.005529689.</p>
<pre class="r"><code>ggplot(cv_results, aes(x = log_lambda, y = mean_mse)) +
  geom_line(color = &quot;blue&quot;, size = 1) +
  geom_ribbon(aes(ymin = lower_mse, ymax = upper_mse), alpha = 0.2, fill = &quot;blue&quot;) +
  geom_vline(xintercept = log_best_lambda, linetype = &quot;dashed&quot;, color = &quot;red&quot;) +
  labs(
    title = &quot;Cross-Validation for Lasso Regression&quot;,
    x = &quot;Log(Lambda)&quot;,
    y = &quot;Mean Cross-Validated Error&quot;
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="regression_files/figure-html/cv_results-1.png" width="672" /></p>
<pre class="r"><code>lasso_coefficients &lt;- coef(cv_model, s = &quot;lambda.min&quot;)

lasso_coefficients_df &lt;- as.data.frame(as.matrix(lasso_coefficients)) %&gt;%
  rownames_to_column(&quot;Variable&quot;) %&gt;%
  rename(Coefficient = 1) %&gt;%
  filter(Coefficient != 0)

kable(
  lasso_coefficients_df,
  col.names = c(&quot;Term&quot;, &quot;Coefficient&quot;),
  caption = &quot;Cross-Validation Results for Lasso Regression&quot;,
  align = &quot;c&quot;,
  digits = 4
) |&gt; 
  kable_styling(
    bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;),
    full_width = TRUE
  ) |&gt; 
  scroll_box(height = &quot;300px&quot;)</code></pre>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Cross-Validation Results for Lasso Regression
</caption>
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Term
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Coefficient
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
X.Intercept.
</td>
<td style="text-align:center;">
1.1137
</td>
</tr>
<tr>
<td style="text-align:center;">
X.Intercept..1
</td>
<td style="text-align:center;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:center;">
year2016
</td>
<td style="text-align:center;">
0.0566
</td>
</tr>
<tr>
<td style="text-align:center;">
year2017
</td>
<td style="text-align:center;">
0.1449
</td>
</tr>
<tr>
<td style="text-align:center;">
year2018
</td>
<td style="text-align:center;">
0.0689
</td>
</tr>
<tr>
<td style="text-align:center;">
year2019
</td>
<td style="text-align:center;">
0.0927
</td>
</tr>
<tr>
<td style="text-align:center;">
year2020
</td>
<td style="text-align:center;">
-0.2825
</td>
</tr>
<tr>
<td style="text-align:center;">
year2021
</td>
<td style="text-align:center;">
-0.2850
</td>
</tr>
<tr>
<td style="text-align:center;">
month2
</td>
<td style="text-align:center;">
-0.0189
</td>
</tr>
<tr>
<td style="text-align:center;">
month3
</td>
<td style="text-align:center;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:center;">
month4
</td>
<td style="text-align:center;">
0.0992
</td>
</tr>
<tr>
<td style="text-align:center;">
month5
</td>
<td style="text-align:center;">
0.1525
</td>
</tr>
<tr>
<td style="text-align:center;">
month6
</td>
<td style="text-align:center;">
0.2211
</td>
</tr>
<tr>
<td style="text-align:center;">
month7
</td>
<td style="text-align:center;">
0.1790
</td>
</tr>
<tr>
<td style="text-align:center;">
month8
</td>
<td style="text-align:center;">
0.2009
</td>
</tr>
<tr>
<td style="text-align:center;">
month9
</td>
<td style="text-align:center;">
0.1142
</td>
</tr>
<tr>
<td style="text-align:center;">
month10
</td>
<td style="text-align:center;">
0.0635
</td>
</tr>
<tr>
<td style="text-align:center;">
month11
</td>
<td style="text-align:center;">
0.0544
</td>
</tr>
<tr>
<td style="text-align:center;">
month12
</td>
<td style="text-align:center;">
-0.0032
</td>
</tr>
<tr>
<td style="text-align:center;">
genderM
</td>
<td style="text-align:center;">
0.8872
</td>
</tr>
<tr>
<td style="text-align:center;">
spay_neuterNeutered
</td>
<td style="text-align:center;">
-0.1027
</td>
</tr>
<tr>
<td style="text-align:center;">
boroughBrooklyn
</td>
<td style="text-align:center;">
0.2970
</td>
</tr>
<tr>
<td style="text-align:center;">
boroughManhattan
</td>
<td style="text-align:center;">
0.2242
</td>
</tr>
<tr>
<td style="text-align:center;">
boroughQueens
</td>
<td style="text-align:center;">
0.4922
</td>
</tr>
<tr>
<td style="text-align:center;">
boroughStaten.Island
</td>
<td style="text-align:center;">
-0.5575
</td>
</tr>
</tbody>
</table>
</div>
<p>In summary, the Lasso regression model selected the following
variables:</p>
<ul>
<li>Time factor: <code>year</code> and <code>month</code></li>
<li>Individual characteristics: <code>gender</code> and
<code>spay_neuter</code></li>
<li>Regional characteristics: <code>borough</code></li>
</ul>
<p>Therefore, these variables need to be included in the subsequent
negative binomial regression analysis.</p>
</div>
<div id="main-effects-model" class="section level2">
<h2>Main effects model</h2>
<p>After employing Lasso regression for feature selection, the study
identified several key variables that influence the occurrence of dog
bite incidents. These variables include the <code>year</code>,
<code>month</code>, <code>gender</code>, <code>spay_neuter</code>, and
<code>borough</code>. These factors will be incorporated into a negative
binomial generalized linear model (<code>glm.nb</code>) to predict the
number of bite incidents.</p>
<div id="results" class="section level3">
<h3>Results</h3>
<p>The results of the main effects model fitting are presented in the
following table.</p>
<p>The dispersion parameter, <span class="math inline">\(\theta =
25.18\)</span>, indicates that the data exhibits overdispersion, meaning
the variance is much larger than the mean. This justifies the use of the
negative binomial regression model over a Poisson regression.</p>
<p>The deviance of the null model (a model with no predictors, only the
intercept) is <span class="math inline">\(3914.5\)</span>. This
represents the deviance of the fitted model with predictors included is
<span class="math inline">\(1549.7\)</span>. The significant reduction
in deviance indicates that the included predictors substantially improve
model fit.</p>
<pre class="r"><code>kable(
  model_summary,
  col.names = c(&quot;Term&quot;, &quot;Estimate&quot;, &quot;SE&quot;, &quot;Statistic&quot;, &quot;P-value&quot;, &quot;Significance&quot;),
  caption = &quot;Summary of Negative Binomial Regression Results&quot;
) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;), full_width = TRUE) %&gt;%
  scroll_box(height = &quot;400px&quot;)</code></pre>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; ">
<table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
Summary of Negative Binomial Regression Results
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Term
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
SE
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
P-value
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Significance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
1.0819840
</td>
<td style="text-align:right;">
0.0594554
</td>
<td style="text-align:right;">
18.1982535
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
year2016
</td>
<td style="text-align:right;">
0.0697408
</td>
<td style="text-align:right;">
0.0415739
</td>
<td style="text-align:right;">
1.6775135
</td>
<td style="text-align:right;">
0.0934421
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
year2017
</td>
<td style="text-align:right;">
0.1535577
</td>
<td style="text-align:right;">
0.0409067
</td>
<td style="text-align:right;">
3.7538482
</td>
<td style="text-align:right;">
0.0001741
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
year2018
</td>
<td style="text-align:right;">
0.0752355
</td>
<td style="text-align:right;">
0.0415347
</td>
<td style="text-align:right;">
1.8113915
</td>
<td style="text-align:right;">
0.0700803
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
year2019
</td>
<td style="text-align:right;">
0.0942075
</td>
<td style="text-align:right;">
0.0413851
</td>
<td style="text-align:right;">
2.2763627
</td>
<td style="text-align:right;">
0.0228243
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
year2020
</td>
<td style="text-align:right;">
-0.2791303
</td>
<td style="text-align:right;">
0.0454262
</td>
<td style="text-align:right;">
-6.1446913
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
year2021
</td>
<td style="text-align:right;">
-0.2870956
</td>
<td style="text-align:right;">
0.0458795
</td>
<td style="text-align:right;">
-6.2576004
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
month2
</td>
<td style="text-align:right;">
0.0025297
</td>
<td style="text-align:right;">
0.0587213
</td>
<td style="text-align:right;">
0.0430799
</td>
<td style="text-align:right;">
0.9656378
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
month3
</td>
<td style="text-align:right;">
0.0299763
</td>
<td style="text-align:right;">
0.0582325
</td>
<td style="text-align:right;">
0.5147697
</td>
<td style="text-align:right;">
0.6067140
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
month4
</td>
<td style="text-align:right;">
0.1274838
</td>
<td style="text-align:right;">
0.0571182
</td>
<td style="text-align:right;">
2.2319298
</td>
<td style="text-align:right;">
0.0256196
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
month5
</td>
<td style="text-align:right;">
0.1807138
</td>
<td style="text-align:right;">
0.0565828
</td>
<td style="text-align:right;">
3.1937937
</td>
<td style="text-align:right;">
0.0014042
</td>
<td style="text-align:left;">
**
</td>
</tr>
<tr>
<td style="text-align:left;">
month6
</td>
<td style="text-align:right;">
0.2447988
</td>
<td style="text-align:right;">
0.0559689
</td>
<td style="text-align:right;">
4.3738342
</td>
<td style="text-align:right;">
0.0000122
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
month7
</td>
<td style="text-align:right;">
0.2019422
</td>
<td style="text-align:right;">
0.0565467
</td>
<td style="text-align:right;">
3.5712485
</td>
<td style="text-align:right;">
0.0003553
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
month8
</td>
<td style="text-align:right;">
0.2276408
</td>
<td style="text-align:right;">
0.0563495
</td>
<td style="text-align:right;">
4.0397994
</td>
<td style="text-align:right;">
0.0000535
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
month9
</td>
<td style="text-align:right;">
0.1429531
</td>
<td style="text-align:right;">
0.0571015
</td>
<td style="text-align:right;">
2.5034925
</td>
<td style="text-align:right;">
0.0122974
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
month10
</td>
<td style="text-align:right;">
0.0912030
</td>
<td style="text-align:right;">
0.0577714
</td>
<td style="text-align:right;">
1.5786867
</td>
<td style="text-align:right;">
0.1144079
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
month11
</td>
<td style="text-align:right;">
0.0888914
</td>
<td style="text-align:right;">
0.0577247
</td>
<td style="text-align:right;">
1.5399200
</td>
<td style="text-align:right;">
0.1235799
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
month12
</td>
<td style="text-align:right;">
0.0185023
</td>
<td style="text-align:right;">
0.0588556
</td>
<td style="text-align:right;">
0.3143674
</td>
<td style="text-align:right;">
0.7532420
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
genderM
</td>
<td style="text-align:right;">
0.8851206
</td>
<td style="text-align:right;">
0.0245208
</td>
<td style="text-align:right;">
36.0966638
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
spay_neuterNeutered
</td>
<td style="text-align:right;">
-0.1122779
</td>
<td style="text-align:right;">
0.0228317
</td>
<td style="text-align:right;">
-4.9176281
</td>
<td style="text-align:right;">
0.0000009
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
boroughBrooklyn
</td>
<td style="text-align:right;">
0.3051114
</td>
<td style="text-align:right;">
0.0361136
</td>
<td style="text-align:right;">
8.4486684
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
boroughManhattan
</td>
<td style="text-align:right;">
0.2376617
</td>
<td style="text-align:right;">
0.0365134
</td>
<td style="text-align:right;">
6.5088955
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
boroughQueens
</td>
<td style="text-align:right;">
0.4981809
</td>
<td style="text-align:right;">
0.0349699
</td>
<td style="text-align:right;">
14.2459962
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
boroughStaten Island
</td>
<td style="text-align:right;">
-0.5517553
</td>
<td style="text-align:right;">
0.0446767
</td>
<td style="text-align:right;">
-12.3499477
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
</div></li>
</ul></li>
</ul></li>
</ul>
<p>Year: Some years (e.g., 2017, 2019) show statistically significant
coefficients, suggesting that the number of bite incidents varies
significantly across years. <code>year2021</code> (Coefficient =
-0.28710, p &lt; 0.001) indicates a significant <em>decrease</em> in
bite counts compared to year2015.</p>
<p>Month: Some months show no significant effects on bite counts (e.g.,
month2: p = 0.97; month3: p = 0.61). Several months (e.g., May, June,
August) have significant coefficients, indicating seasonality in bite
incidents.</p>
<p>Gender: Male dogs (genderM) are associated with a significantly
higher bite count, as indicated by the large positive coefficient.</p>
<p>Spay/Neuter: Neutered dogs are associated with a lower bite count,
with a statistically significant negative coefficient.</p>
<p>Boroughs: Bite counts vary across boroughs, with Staten Island
showing a significant negative association compared to the reference
borough.</p>
<p>From the coefficient of fitting results, this study draws the
following conclusions:</p>
<ul>
<li><p>Different years have significantly impacted bite counts,
particularly after 2020, where a notable reduction in incidents was
observed. This might reflect external factors, such as the COVID-19
pandemic.</p></li>
<li><p>Monthly effects highlight significant seasonal variation, with
summer months (e.g., June) showing higher bite counts.</p></li>
<li><p>Males are significantly more likely to be involved in bite
incidents than females.</p></li>
<li><p>Neutered animals have significantly lower bite risks compared to
non-neutered ones.</p></li>
<li><p>Brooklyn has significantly higher bite counts, while Staten
Island has significantly fewer bites compared to Bronx. These
differences might reflect variations in dog management policies,
population density, or dog ownership practices across regions.</p></li>
</ul>
<div id="evaluation" class="section level3">
<h3>Evaluation</h3>
<p>After obtaining the fitted results, it is crucial to perform a
multicollinearity test on the model to ensure the reliability of the
regression coefficients. Multicollinearity can severely affect the
interpretability of the model and can lead to overinflated standard
errors, making it difficult to discern the true effect of each
predictor.</p>
<pre class="r"><code>library(car)
vif_results &lt;- vif(model) %&gt;%
  as.data.frame() %&gt;%
  rownames_to_column(&quot;Predictor&quot;) %&gt;%
  rename(
    GVIF = GVIF,
    DF = Df,
    `GVIF^(1/(2*DF))` = `GVIF^(1/(2*Df))`
  )

kable(
  vif_results,
  col.names = c(&quot;Predictor&quot;, &quot;GVIF&quot;, &quot;DF&quot;, &quot;Scaled GVIF&quot;),
  caption = &quot;Multicollinearity Check (GVIF)&quot;
) |&gt; 
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;), full_width = TRUE)</code></pre>
<table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
Multicollinearity Check (GVIF)
</caption>
<thead>
<tr>
<th style="text-align:left;">
Predictor
</th>
<th style="text-align:right;">
GVIF
</th>
<th style="text-align:right;">
DF
</th>
<th style="text-align:right;">
Scaled GVIF
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
year
</td>
<td style="text-align:right;">
1.004775
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1.000397
</td>
</tr>
<tr>
<td style="text-align:left;">
month
</td>
<td style="text-align:right;">
1.002312
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
1.000105
</td>
</tr>
<tr>
<td style="text-align:left;">
gender
</td>
<td style="text-align:right;">
1.003175
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.001586
</td>
</tr>
<tr>
<td style="text-align:left;">
spay_neuter
</td>
<td style="text-align:right;">
1.001316
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.000658
</td>
</tr>
<tr>
<td style="text-align:left;">
borough
</td>
<td style="text-align:right;">
1.005447
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1.000679
</td>
</tr>
</tbody>
</table>
<p>Generalized Variance Inflation Factor (GVIF) measures the
multicollinearity in the regression model. A GVIF value greater than 10
generally indicates a high multicollinearity issue. All GVIF values are
close to 1, suggesting no significant multicollinearity.</p>
<p>Scaled GVIF adjusts GVIF based on the degrees of freedom to make it
comparable across variables. It is defined as <span
class="math inline">\(GVIF^{(1/(2*Df))}\)</span>. As shown in the table
above, the GVIF and scaled GVIF are all close to 1, indicating that
there is no significant multicollinearity in the final model.</p>
<p>As shown in the table above, results does not exhibit
multicollinearity among the predictors, as all GVIF values and their
scaled counterparts are well below the threshold of concern (commonly 10
or higher). This indicates that all predictors can be reliably used in
regression model without the risk of biased coefficients caused by
multicollinearity.</p>
<pre class="r"><code>library(DHARMa)
residuals_sim = simulateResiduals(model)
plot(residuals_sim)</code></pre>
<p><img src="regression_files/figure-html/residuals_sim-1.png" width="672" /></p>
<p><code>Q-Q Plot</code>:</p>
<ul>
<li>KS Test p-value (0.7167): Indicates that the residuals do not
significantly deviate from a uniform distribution. This suggests that
the model residuals are well-behaved.</li>
<li>Dispersion Test p-value (0.936): Suggests there is no significant
over- or under-dispersion in the model, further supporting the
appropriateness of the negative binomial distribution.</li>
<li>Outlier Test p-value (0.19983): Shows that there are no significant
outliers in the residuals, meaning that most predictions align with the
observed data.</li>
</ul>
<p>The residuals closely follow the expected line, indicating a good fit
in terms of normality for the main effects-only model.</p>
<p><code>Residuals vs Predicted</code>:</p>
<ul>
<li>The residuals appear to be well-distributed, with most points
clustering around the 0.5 quantile line.</li>
<li>The red curves (quantile deviations) show minor deviations,
particularly near the tails (e.g., quantiles close to 0 and 1). However,
these deviations are not substantial enough to indicate severe model
misspecification.</li>
<li>The presence of small red asterisks (*) at the upper quantiles
suggests slight issues with model fit in extreme predictions, but these
deviations are minor.</li>
</ul>
<p>This shows some spread and potential systematic patterns, indicating
the main effects model might <em>not fully</em> capture the variability
in the data.</p>
</div>
<div id="model-with-interaction" class="section level2">
<h2>Model with interaction</h2>
<p>To further increase the precision of the model fit, interaction terms
between variables were added.</p>
<div id="results-1" class="section level3">
<h3>Results</h3>
<pre class="r"><code>model_all_interactions &lt;- glm.nb(
  formula = bite_count ~ 
    year + month + gender + spay_neuter + borough +
    year * month + year * gender + year * spay_neuter + year * borough +
    month * gender + month * spay_neuter + month * borough +
    gender * spay_neuter + gender * borough + spay_neuter * borough +
    year * month * gender + year * month * spay_neuter + year * month * borough + 
    year * gender * spay_neuter + year * gender * borough + year * spay_neuter * borough +
    month * gender * spay_neuter + month * gender * borough + month * spay_neuter * borough +
    gender * spay_neuter * borough,
  data = bites_by_group
)

model_stepwise &lt;- stepAIC(model_all_interactions, direction = &quot;both&quot;)</code></pre>
<p>After using stepwise reduction to simplify the model complexity, the
variables of final negative binomial regression model are as follow:</p>
<pre class="r"><code>data &lt;- data.frame(
  `Main Effect` = c(&quot;year&quot;, &quot;month&quot;, &quot;gender&quot;, &quot;spay_neuter&quot;, &quot;borough&quot;, &quot; &quot;),
  `Double Interaction Effect` = c(
    &quot;year * spay_neuter&quot;,
    &quot;year * borough&quot;,
    &quot;month * spay_neuter&quot;,
    &quot;gender * spay_neuter&quot;,
    &quot;gender * borough&quot;,
    &quot;spay_neuter * borough&quot;
  )
)

knitr::kable(data, format = &quot;pipe&quot;, align = &quot;l&quot;, caption = &quot;Final Negative Binomial Regression Model&quot;, escape = FALSE)</code></pre>
<table>
<caption>Final Negative Binomial Regression Model</caption>
<thead>
<tr class="header">
<th align="left">Main.Effect</th>
<th align="left">Double.Interaction.Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="left">year * spay_neuter</td>
</tr>
<tr class="even">
<td align="left">month</td>
<td align="left">year * borough</td>
</tr>
<tr class="odd">
<td align="left">gender</td>
<td align="left">month * spay_neuter</td>
</tr>
<tr class="even">
<td align="left">spay_neuter</td>
<td align="left">gender * spay_neuter</td>
</tr>
<tr class="odd">
<td align="left">borough</td>
<td align="left">gender * borough</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">spay_neuter * borough</td>
</tr>
</tbody>
</table>
<p>The final model with interaction is detailed in the following table.
Initially, the intercept is 3.83 with a p-value near zero, indicating
that the baseline level of the response variable (on a logarithmic
scale) is significant when other variables are not considered. For the
main effect variables, the years 2016, 2018, and 2019 show a significant
increase in the log change of event counts compared to 2015; male dogs,
compared to female dogs, exhibit stronger aggression, with a 10.59 times
increase in the incidence of dog bite events, calculated as with <span
class="math inline">\(e^{2.36}\)</span>. The coefficient for neutering,
0.3960, indicates a significant reduction in the log count of bite
incidents for neutered dogs compared to unneutered dogs. Geographically,
the coefficients for Manhattan and Staten Island are 0.72 and 0.48,
respectively, showing significantly lower event counts compared to the
Bronx. Regarding interaction terms, the years 2018, 2020, and 2021 show
a significant reduction in interaction with the neutering status.</p>
<pre class="r"><code>filter_model = glm.nb(bite_count ~ year + month + gender + spay_neuter + 
    borough + year:spay_neuter + year:borough + month:spay_neuter + 
    gender:spay_neuter + gender:borough + spay_neuter:borough, 
    data = bites_by_group)

filter_model_summary &lt;- tidy(filter_model, exponentiate = TRUE, conf.int = TRUE)

kable(
  filter_model_summary,
  caption = &quot;Summary of Negative Binomial Regression (with interactions) Results&quot;
) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;), full_width = TRUE) %&gt;%
  scroll_box(height = &quot;400px&quot;)</code></pre>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; ">
<table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
Summary of Negative Binomial Regression (with interactions) Results
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
term
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
conf.low
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
3.8266218
</td>
<td style="text-align:right;">
0.0917147
</td>
<td style="text-align:right;">
14.6321455
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
3.1897224
</td>
<td style="text-align:right;">
4.5699845
</td>
</tr>
<tr>
<td style="text-align:left;">
year2016
</td>
<td style="text-align:right;">
1.3033610
</td>
<td style="text-align:right;">
0.0901036
</td>
<td style="text-align:right;">
2.9404628
</td>
<td style="text-align:right;">
0.0032772
</td>
<td style="text-align:right;">
1.0929752
</td>
<td style="text-align:right;">
1.5562867
</td>
</tr>
<tr>
<td style="text-align:left;">
year2017
</td>
<td style="text-align:right;">
1.1385007
</td>
<td style="text-align:right;">
0.0922903
</td>
<td style="text-align:right;">
1.4054815
</td>
<td style="text-align:right;">
0.1598781
</td>
<td style="text-align:right;">
0.9504021
</td>
<td style="text-align:right;">
1.3649459
</td>
</tr>
<tr>
<td style="text-align:left;">
year2018
</td>
<td style="text-align:right;">
1.3118411
</td>
<td style="text-align:right;">
0.0908169
</td>
<td style="text-align:right;">
2.9887793
</td>
<td style="text-align:right;">
0.0028009
</td>
<td style="text-align:right;">
1.0984502
</td>
<td style="text-align:right;">
1.5684738
</td>
</tr>
<tr>
<td style="text-align:left;">
year2019
</td>
<td style="text-align:right;">
1.3122458
</td>
<td style="text-align:right;">
0.0905443
</td>
<td style="text-align:right;">
3.0011837
</td>
<td style="text-align:right;">
0.0026893
</td>
<td style="text-align:right;">
1.0994102
</td>
<td style="text-align:right;">
1.5681645
</td>
</tr>
<tr>
<td style="text-align:left;">
year2020
</td>
<td style="text-align:right;">
0.8228914
</td>
<td style="text-align:right;">
0.1047046
</td>
<td style="text-align:right;">
-1.8617234
</td>
<td style="text-align:right;">
0.0626421
</td>
<td style="text-align:right;">
0.6693712
</td>
<td style="text-align:right;">
1.0093955
</td>
</tr>
<tr>
<td style="text-align:left;">
year2021
</td>
<td style="text-align:right;">
0.8059884
</td>
<td style="text-align:right;">
0.1072938
</td>
<td style="text-align:right;">
-2.0102369
</td>
<td style="text-align:right;">
0.0444061
</td>
<td style="text-align:right;">
0.6520723
</td>
<td style="text-align:right;">
0.9933690
</td>
</tr>
<tr>
<td style="text-align:left;">
month2
</td>
<td style="text-align:right;">
0.9729195
</td>
<td style="text-align:right;">
0.0695666
</td>
<td style="text-align:right;">
-0.3946429
</td>
<td style="text-align:right;">
0.6931064
</td>
<td style="text-align:right;">
0.8487826
</td>
<td style="text-align:right;">
1.1149947
</td>
</tr>
<tr>
<td style="text-align:left;">
month3
</td>
<td style="text-align:right;">
1.0105442
</td>
<td style="text-align:right;">
0.0684963
</td>
<td style="text-align:right;">
0.1531328
</td>
<td style="text-align:right;">
0.8782936
</td>
<td style="text-align:right;">
0.8835430
</td>
<td style="text-align:right;">
1.1557926
</td>
</tr>
<tr>
<td style="text-align:left;">
month4
</td>
<td style="text-align:right;">
0.9934017
</td>
<td style="text-align:right;">
0.0684907
</td>
<td style="text-align:right;">
-0.0966578
</td>
<td style="text-align:right;">
0.9229981
</td>
<td style="text-align:right;">
0.8685643
</td>
<td style="text-align:right;">
1.1361738
</td>
</tr>
<tr>
<td style="text-align:left;">
month5
</td>
<td style="text-align:right;">
1.0680211
</td>
<td style="text-align:right;">
0.0672828
</td>
<td style="text-align:right;">
0.9780735
</td>
<td style="text-align:right;">
0.3280380
</td>
<td style="text-align:right;">
0.9361209
</td>
<td style="text-align:right;">
1.2187538
</td>
</tr>
<tr>
<td style="text-align:left;">
month6
</td>
<td style="text-align:right;">
1.1690766
</td>
<td style="text-align:right;">
0.0657587
</td>
<td style="text-align:right;">
2.3755679
</td>
<td style="text-align:right;">
0.0175220
</td>
<td style="text-align:right;">
1.0278987
</td>
<td style="text-align:right;">
1.3302616
</td>
</tr>
<tr>
<td style="text-align:left;">
month7
</td>
<td style="text-align:right;">
1.2098715
</td>
<td style="text-align:right;">
0.0654067
</td>
<td style="text-align:right;">
2.9127615
</td>
<td style="text-align:right;">
0.0035825
</td>
<td style="text-align:right;">
1.0645334
</td>
<td style="text-align:right;">
1.3757713
</td>
</tr>
<tr>
<td style="text-align:left;">
month8
</td>
<td style="text-align:right;">
1.1509696
</td>
<td style="text-align:right;">
0.0664863
</td>
<td style="text-align:right;">
2.1147913
</td>
<td style="text-align:right;">
0.0344477
</td>
<td style="text-align:right;">
1.0104735
</td>
<td style="text-align:right;">
1.3114496
</td>
</tr>
<tr>
<td style="text-align:left;">
month9
</td>
<td style="text-align:right;">
1.0335144
</td>
<td style="text-align:right;">
0.0680631
</td>
<td style="text-align:right;">
0.4843299
</td>
<td style="text-align:right;">
0.6281517
</td>
<td style="text-align:right;">
0.9044289
</td>
<td style="text-align:right;">
1.1811049
</td>
</tr>
<tr>
<td style="text-align:left;">
month10
</td>
<td style="text-align:right;">
1.0959521
</td>
<td style="text-align:right;">
0.0673646
</td>
<td style="text-align:right;">
1.3601127
</td>
<td style="text-align:right;">
0.1737943
</td>
<td style="text-align:right;">
0.9604423
</td>
<td style="text-align:right;">
1.2508199
</td>
</tr>
<tr>
<td style="text-align:left;">
month11
</td>
<td style="text-align:right;">
1.0178300
</td>
<td style="text-align:right;">
0.0683075
</td>
<td style="text-align:right;">
0.2587259
</td>
<td style="text-align:right;">
0.7958467
</td>
<td style="text-align:right;">
0.8902585
</td>
<td style="text-align:right;">
1.1637148
</td>
</tr>
<tr>
<td style="text-align:left;">
month12
</td>
<td style="text-align:right;">
0.9873063
</td>
<td style="text-align:right;">
0.0689063
</td>
<td style="text-align:right;">
-0.1853956
</td>
<td style="text-align:right;">
0.8529188
</td>
<td style="text-align:right;">
0.8625001
</td>
<td style="text-align:right;">
1.1300826
</td>
</tr>
<tr>
<td style="text-align:left;">
genderM
</td>
<td style="text-align:right;">
2.3603576
</td>
<td style="text-align:right;">
0.0546184
</td>
<td style="text-align:right;">
15.7238806
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
2.1222253
</td>
<td style="text-align:right;">
2.6290269
</td>
</tr>
<tr>
<td style="text-align:left;">
spay_neuterNeutered
</td>
<td style="text-align:right;">
0.3960162
</td>
<td style="text-align:right;">
0.1090476
</td>
<td style="text-align:right;">
-8.4944592
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.3196063
</td>
<td style="text-align:right;">
0.4900996
</td>
</tr>
<tr>
<td style="text-align:left;">
boroughBrooklyn
</td>
<td style="text-align:right;">
1.1484679
</td>
<td style="text-align:right;">
0.1007295
</td>
<td style="text-align:right;">
1.3742626
</td>
<td style="text-align:right;">
0.1693602
</td>
<td style="text-align:right;">
0.9433984
</td>
<td style="text-align:right;">
1.4003372
</td>
</tr>
<tr>
<td style="text-align:left;">
boroughManhattan
</td>
<td style="text-align:right;">
0.7189159
</td>
<td style="text-align:right;">
0.1083180
</td>
<td style="text-align:right;">
-3.0466848
</td>
<td style="text-align:right;">
0.0023138
</td>
<td style="text-align:right;">
0.5815085
</td>
<td style="text-align:right;">
0.8892388
</td>
</tr>
<tr>
<td style="text-align:left;">
boroughQueens
</td>
<td style="text-align:right;">
1.0052349
</td>
<td style="text-align:right;">
0.1004848
</td>
<td style="text-align:right;">
0.0519610
</td>
<td style="text-align:right;">
0.9585598
</td>
<td style="text-align:right;">
0.8261307
</td>
<td style="text-align:right;">
1.2250977
</td>
</tr>
<tr>
<td style="text-align:left;">
boroughStaten Island
</td>
<td style="text-align:right;">
0.4792828
</td>
<td style="text-align:right;">
0.1295018
</td>
<td style="text-align:right;">
-5.6791829
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.3711956
</td>
<td style="text-align:right;">
0.6168309
</td>
</tr>
<tr>
<td style="text-align:left;">
year2016:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.0612336
</td>
<td style="text-align:right;">
0.0738846
</td>
<td style="text-align:right;">
0.8043893
</td>
<td style="text-align:right;">
0.4211722
</td>
<td style="text-align:right;">
0.9181842
</td>
<td style="text-align:right;">
1.2266608
</td>
</tr>
<tr>
<td style="text-align:left;">
year2017:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.1261719
</td>
<td style="text-align:right;">
0.0722120
</td>
<td style="text-align:right;">
1.6454912
</td>
<td style="text-align:right;">
0.0998686
</td>
<td style="text-align:right;">
0.9775818
</td>
<td style="text-align:right;">
1.2974768
</td>
</tr>
<tr>
<td style="text-align:left;">
year2018:spay_neuterNeutered
</td>
<td style="text-align:right;">
0.8361551
</td>
<td style="text-align:right;">
0.0738241
</td>
<td style="text-align:right;">
-2.4238853
</td>
<td style="text-align:right;">
0.0153555
</td>
<td style="text-align:right;">
0.7234554
</td>
<td style="text-align:right;">
0.9662810
</td>
</tr>
<tr>
<td style="text-align:left;">
year2019:spay_neuterNeutered
</td>
<td style="text-align:right;">
0.8999070
</td>
<td style="text-align:right;">
0.0732977
</td>
<td style="text-align:right;">
-1.4388429
</td>
<td style="text-align:right;">
0.1501950
</td>
<td style="text-align:right;">
0.7794484
</td>
<td style="text-align:right;">
1.0389210
</td>
</tr>
<tr>
<td style="text-align:left;">
year2020:spay_neuterNeutered
</td>
<td style="text-align:right;">
0.7093584
</td>
<td style="text-align:right;">
0.0832625
</td>
<td style="text-align:right;">
-4.1242377
</td>
<td style="text-align:right;">
0.0000372
</td>
<td style="text-align:right;">
0.6023798
</td>
<td style="text-align:right;">
0.8349059
</td>
</tr>
<tr>
<td style="text-align:left;">
year2021:spay_neuterNeutered
</td>
<td style="text-align:right;">
0.7033678
</td>
<td style="text-align:right;">
0.0842494
</td>
<td style="text-align:right;">
-4.1765924
</td>
<td style="text-align:right;">
0.0000296
</td>
<td style="text-align:right;">
0.5961124
</td>
<td style="text-align:right;">
0.8294237
</td>
</tr>
<tr>
<td style="text-align:left;">
year2016:boroughBrooklyn
</td>
<td style="text-align:right;">
0.6696158
</td>
<td style="text-align:right;">
0.1136113
</td>
<td style="text-align:right;">
-3.5300282
</td>
<td style="text-align:right;">
0.0004155
</td>
<td style="text-align:right;">
0.5356558
</td>
<td style="text-align:right;">
0.8362826
</td>
</tr>
<tr>
<td style="text-align:left;">
year2017:boroughBrooklyn
</td>
<td style="text-align:right;">
0.8016684
</td>
<td style="text-align:right;">
0.1146289
</td>
<td style="text-align:right;">
-1.9284860
</td>
<td style="text-align:right;">
0.0537947
</td>
<td style="text-align:right;">
0.6401252
</td>
<td style="text-align:right;">
1.0033867
</td>
</tr>
<tr>
<td style="text-align:left;">
year2018:boroughBrooklyn
</td>
<td style="text-align:right;">
0.6156245
</td>
<td style="text-align:right;">
0.1168101
</td>
<td style="text-align:right;">
-4.1530513
</td>
<td style="text-align:right;">
0.0000328
</td>
<td style="text-align:right;">
0.4893635
</td>
<td style="text-align:right;">
0.7736536
</td>
</tr>
<tr>
<td style="text-align:left;">
year2019:boroughBrooklyn
</td>
<td style="text-align:right;">
0.6430267
</td>
<td style="text-align:right;">
0.1158853
</td>
<td style="text-align:right;">
-3.8103961
</td>
<td style="text-align:right;">
0.0001387
</td>
<td style="text-align:right;">
0.5120816
</td>
<td style="text-align:right;">
0.8066385
</td>
</tr>
<tr>
<td style="text-align:left;">
year2020:boroughBrooklyn
</td>
<td style="text-align:right;">
0.9194226
</td>
<td style="text-align:right;">
0.1308903
</td>
<td style="text-align:right;">
-0.6418304
</td>
<td style="text-align:right;">
0.5209833
</td>
<td style="text-align:right;">
0.7116333
</td>
<td style="text-align:right;">
1.1889894
</td>
</tr>
<tr>
<td style="text-align:left;">
year2021:boroughBrooklyn
</td>
<td style="text-align:right;">
0.9169286
</td>
<td style="text-align:right;">
0.1340716
</td>
<td style="text-align:right;">
-0.6468607
</td>
<td style="text-align:right;">
0.5177221
</td>
<td style="text-align:right;">
0.7053947
</td>
<td style="text-align:right;">
1.1933845
</td>
</tr>
<tr>
<td style="text-align:left;">
year2016:boroughManhattan
</td>
<td style="text-align:right;">
0.7672008
</td>
<td style="text-align:right;">
0.1219690
</td>
<td style="text-align:right;">
-2.1727381
</td>
<td style="text-align:right;">
0.0298000
</td>
<td style="text-align:right;">
0.6038442
</td>
<td style="text-align:right;">
0.9741476
</td>
</tr>
<tr>
<td style="text-align:left;">
year2017:boroughManhattan
</td>
<td style="text-align:right;">
1.0056926
</td>
<td style="text-align:right;">
0.1214035
</td>
<td style="text-align:right;">
0.0467566
</td>
<td style="text-align:right;">
0.9627072
</td>
<td style="text-align:right;">
0.7926301
</td>
<td style="text-align:right;">
1.2758780
</td>
</tr>
<tr>
<td style="text-align:left;">
year2018:boroughManhattan
</td>
<td style="text-align:right;">
1.0764166
</td>
<td style="text-align:right;">
0.1200012
</td>
<td style="text-align:right;">
0.6136403
</td>
<td style="text-align:right;">
0.5394531
</td>
<td style="text-align:right;">
0.8507054
</td>
<td style="text-align:right;">
1.3618503
</td>
</tr>
<tr>
<td style="text-align:left;">
year2019:boroughManhattan
</td>
<td style="text-align:right;">
1.0374713
</td>
<td style="text-align:right;">
0.1197084
</td>
<td style="text-align:right;">
0.3072990
</td>
<td style="text-align:right;">
0.7586158
</td>
<td style="text-align:right;">
0.8203777
</td>
<td style="text-align:right;">
1.3117924
</td>
</tr>
<tr>
<td style="text-align:left;">
year2020:boroughManhattan
</td>
<td style="text-align:right;">
1.3188623
</td>
<td style="text-align:right;">
0.1365701
</td>
<td style="text-align:right;">
2.0265749
</td>
<td style="text-align:right;">
0.0427059
</td>
<td style="text-align:right;">
1.0096615
</td>
<td style="text-align:right;">
1.7248937
</td>
</tr>
<tr>
<td style="text-align:left;">
year2021:boroughManhattan
</td>
<td style="text-align:right;">
1.2422379
</td>
<td style="text-align:right;">
0.1397488
</td>
<td style="text-align:right;">
1.5521743
</td>
<td style="text-align:right;">
0.1206205
</td>
<td style="text-align:right;">
0.9452097
</td>
<td style="text-align:right;">
1.6350671
</td>
</tr>
<tr>
<td style="text-align:left;">
year2016:boroughQueens
</td>
<td style="text-align:right;">
0.8140961
</td>
<td style="text-align:right;">
0.1136471
</td>
<td style="text-align:right;">
-1.8097847
</td>
<td style="text-align:right;">
0.0703292
</td>
<td style="text-align:right;">
0.6512614
</td>
<td style="text-align:right;">
1.0169129
</td>
</tr>
<tr>
<td style="text-align:left;">
year2017:boroughQueens
</td>
<td style="text-align:right;">
1.0867730
</td>
<td style="text-align:right;">
0.1135860
</td>
<td style="text-align:right;">
0.7325963
</td>
<td style="text-align:right;">
0.4638047
</td>
<td style="text-align:right;">
0.8696893
</td>
<td style="text-align:right;">
1.3576659
</td>
</tr>
<tr>
<td style="text-align:left;">
year2018:boroughQueens
</td>
<td style="text-align:right;">
1.0448140
</td>
<td style="text-align:right;">
0.1131393
</td>
<td style="text-align:right;">
0.3874768
</td>
<td style="text-align:right;">
0.6984032
</td>
<td style="text-align:right;">
0.8367859
</td>
<td style="text-align:right;">
1.3040097
</td>
</tr>
<tr>
<td style="text-align:left;">
year2019:boroughQueens
</td>
<td style="text-align:right;">
1.0220010
</td>
<td style="text-align:right;">
0.1127442
</td>
<td style="text-align:right;">
0.1930255
</td>
<td style="text-align:right;">
0.8469390
</td>
<td style="text-align:right;">
0.8191320
</td>
<td style="text-align:right;">
1.2745219
</td>
</tr>
<tr>
<td style="text-align:left;">
year2020:boroughQueens
</td>
<td style="text-align:right;">
1.1261820
</td>
<td style="text-align:right;">
0.1306208
</td>
<td style="text-align:right;">
0.9097565
</td>
<td style="text-align:right;">
0.3629509
</td>
<td style="text-align:right;">
0.8722475
</td>
<td style="text-align:right;">
1.4557937
</td>
</tr>
<tr>
<td style="text-align:left;">
year2021:boroughQueens
</td>
<td style="text-align:right;">
1.2916043
</td>
<td style="text-align:right;">
0.1315466
</td>
<td style="text-align:right;">
1.9452047
</td>
<td style="text-align:right;">
0.0517504
</td>
<td style="text-align:right;">
0.9988859
</td>
<td style="text-align:right;">
1.6732506
</td>
</tr>
<tr>
<td style="text-align:left;">
year2016:boroughStaten Island
</td>
<td style="text-align:right;">
0.8644796
</td>
<td style="text-align:right;">
0.1431569
</td>
<td style="text-align:right;">
-1.0172580
</td>
<td style="text-align:right;">
0.3090307
</td>
<td style="text-align:right;">
0.6528959
</td>
<td style="text-align:right;">
1.1446386
</td>
</tr>
<tr>
<td style="text-align:left;">
year2017:boroughStaten Island
</td>
<td style="text-align:right;">
0.9866068
</td>
<td style="text-align:right;">
0.1425223
</td>
<td style="text-align:right;">
-0.0946074
</td>
<td style="text-align:right;">
0.9246267
</td>
<td style="text-align:right;">
0.7462658
</td>
<td style="text-align:right;">
1.3050651
</td>
</tr>
<tr>
<td style="text-align:left;">
year2018:boroughStaten Island
</td>
<td style="text-align:right;">
0.8321089
</td>
<td style="text-align:right;">
0.1483069
</td>
<td style="text-align:right;">
-1.2392683
</td>
<td style="text-align:right;">
0.2152461
</td>
<td style="text-align:right;">
0.6218356
</td>
<td style="text-align:right;">
1.1124636
</td>
</tr>
<tr>
<td style="text-align:left;">
year2019:boroughStaten Island
</td>
<td style="text-align:right;">
0.7854488
</td>
<td style="text-align:right;">
0.1468059
</td>
<td style="text-align:right;">
-1.6450292
</td>
<td style="text-align:right;">
0.0999638
</td>
<td style="text-align:right;">
0.5887784
</td>
<td style="text-align:right;">
1.0471310
</td>
</tr>
<tr>
<td style="text-align:left;">
year2020:boroughStaten Island
</td>
<td style="text-align:right;">
0.8911374
</td>
<td style="text-align:right;">
0.1789898
</td>
<td style="text-align:right;">
-0.6439284
</td>
<td style="text-align:right;">
0.5196219
</td>
<td style="text-align:right;">
0.6254889
</td>
<td style="text-align:right;">
1.2624986
</td>
</tr>
<tr>
<td style="text-align:left;">
year2021:boroughStaten Island
</td>
<td style="text-align:right;">
0.7210547
</td>
<td style="text-align:right;">
0.1929227
</td>
<td style="text-align:right;">
-1.6951883
</td>
<td style="text-align:right;">
0.0900397
</td>
<td style="text-align:right;">
0.4913490
</td>
<td style="text-align:right;">
1.0477969
</td>
</tr>
<tr>
<td style="text-align:left;">
month2:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.0975279
</td>
<td style="text-align:right;">
0.1046014
</td>
<td style="text-align:right;">
0.8896655
</td>
<td style="text-align:right;">
0.3736455
</td>
<td style="text-align:right;">
0.8942084
</td>
<td style="text-align:right;">
1.3475758
</td>
</tr>
<tr>
<td style="text-align:left;">
month3:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.0590365
</td>
<td style="text-align:right;">
0.1038588
</td>
<td style="text-align:right;">
0.5522843
</td>
<td style="text-align:right;">
0.5807536
</td>
<td style="text-align:right;">
0.8640731
</td>
<td style="text-align:right;">
1.2983755
</td>
</tr>
<tr>
<td style="text-align:left;">
month4:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.3564416
</td>
<td style="text-align:right;">
0.1010573
</td>
<td style="text-align:right;">
3.0167522
</td>
<td style="text-align:right;">
0.0025550
</td>
<td style="text-align:right;">
1.1130392
</td>
<td style="text-align:right;">
1.6541988
</td>
</tr>
<tr>
<td style="text-align:left;">
month5:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.3064944
</td>
<td style="text-align:right;">
0.0998785
</td>
<td style="text-align:right;">
2.6767279
</td>
<td style="text-align:right;">
0.0074345
</td>
<td style="text-align:right;">
1.0745154
</td>
<td style="text-align:right;">
1.5895806
</td>
</tr>
<tr>
<td style="text-align:left;">
month6:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.2478170
</td>
<td style="text-align:right;">
0.0984299
</td>
<td style="text-align:right;">
2.2492726
</td>
<td style="text-align:right;">
0.0244952
</td>
<td style="text-align:right;">
1.0291517
</td>
<td style="text-align:right;">
1.5138497
</td>
</tr>
<tr>
<td style="text-align:left;">
month7:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.0553692
</td>
<td style="text-align:right;">
0.0998428
</td>
<td style="text-align:right;">
0.5397557
</td>
<td style="text-align:right;">
0.5893656
</td>
<td style="text-align:right;">
0.8679186
</td>
<td style="text-align:right;">
1.2837758
</td>
</tr>
<tr>
<td style="text-align:left;">
month8:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.2270280
</td>
<td style="text-align:right;">
0.0991555
</td>
<td style="text-align:right;">
2.0633748
</td>
<td style="text-align:right;">
0.0390770
</td>
<td style="text-align:right;">
1.0105739
</td>
<td style="text-align:right;">
1.4907576
</td>
</tr>
<tr>
<td style="text-align:left;">
month9:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.2860456
</td>
<td style="text-align:right;">
0.1009214
</td>
<td style="text-align:right;">
2.4927527
</td>
<td style="text-align:right;">
0.0126757
</td>
<td style="text-align:right;">
1.0555295
</td>
<td style="text-align:right;">
1.5678926
</td>
</tr>
<tr>
<td style="text-align:left;">
month10:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.0214410
</td>
<td style="text-align:right;">
0.1025915
</td>
<td style="text-align:right;">
0.2067852
</td>
<td style="text-align:right;">
0.8361776
</td>
<td style="text-align:right;">
0.8354704
</td>
<td style="text-align:right;">
1.2491730
</td>
</tr>
<tr>
<td style="text-align:left;">
month11:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.1718216
</td>
<td style="text-align:right;">
0.1024908
</td>
<td style="text-align:right;">
1.5470612
</td>
<td style="text-align:right;">
0.1218485
</td>
<td style="text-align:right;">
0.9587419
</td>
<td style="text-align:right;">
1.4329166
</td>
</tr>
<tr>
<td style="text-align:left;">
month12:spay_neuterNeutered
</td>
<td style="text-align:right;">
1.0804447
</td>
<td style="text-align:right;">
0.1049678
</td>
<td style="text-align:right;">
0.7371092
</td>
<td style="text-align:right;">
0.4610559
</td>
<td style="text-align:right;">
0.8795844
</td>
<td style="text-align:right;">
1.3274456
</td>
</tr>
<tr>
<td style="text-align:left;">
genderM:spay_neuterNeutered
</td>
<td style="text-align:right;">
0.8800375
</td>
<td style="text-align:right;">
0.0453079
</td>
<td style="text-align:right;">
-2.8204976
</td>
<td style="text-align:right;">
0.0047949
</td>
<td style="text-align:right;">
0.8052402
</td>
<td style="text-align:right;">
0.9617512
</td>
</tr>
<tr>
<td style="text-align:left;">
genderM:boroughBrooklyn
</td>
<td style="text-align:right;">
1.1720073
</td>
<td style="text-align:right;">
0.0714328
</td>
<td style="text-align:right;">
2.2219198
</td>
<td style="text-align:right;">
0.0262887
</td>
<td style="text-align:right;">
1.0187251
</td>
<td style="text-align:right;">
1.3479804
</td>
</tr>
<tr>
<td style="text-align:left;">
genderM:boroughManhattan
</td>
<td style="text-align:right;">
1.1329946
</td>
<td style="text-align:right;">
0.0725463
</td>
<td style="text-align:right;">
1.7211669
</td>
<td style="text-align:right;">
0.0852205
</td>
<td style="text-align:right;">
0.9826828
</td>
<td style="text-align:right;">
1.3059767
</td>
</tr>
<tr>
<td style="text-align:left;">
genderM:boroughQueens
</td>
<td style="text-align:right;">
1.1693112
</td>
<td style="text-align:right;">
0.0684173
</td>
<td style="text-align:right;">
2.2861904
</td>
<td style="text-align:right;">
0.0222431
</td>
<td style="text-align:right;">
1.0222794
</td>
<td style="text-align:right;">
1.3367837
</td>
</tr>
<tr>
<td style="text-align:left;">
genderM:boroughStaten Island
</td>
<td style="text-align:right;">
0.9069992
</td>
<td style="text-align:right;">
0.0917203
</td>
<td style="text-align:right;">
-1.0642550
</td>
<td style="text-align:right;">
0.2872132
</td>
<td style="text-align:right;">
0.7582574
</td>
<td style="text-align:right;">
1.0864392
</td>
</tr>
<tr>
<td style="text-align:left;">
spay_neuterNeutered:boroughBrooklyn
</td>
<td style="text-align:right;">
2.4562537
</td>
<td style="text-align:right;">
0.0693940
</td>
<td style="text-align:right;">
12.9497913
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
2.1451226
</td>
<td style="text-align:right;">
2.8158263
</td>
</tr>
<tr>
<td style="text-align:left;">
spay_neuterNeutered:boroughManhattan
</td>
<td style="text-align:right;">
3.1397417
</td>
<td style="text-align:right;">
0.0704595
</td>
<td style="text-align:right;">
16.2382769
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
2.7364237
</td>
<td style="text-align:right;">
3.6070334
</td>
</tr>
<tr>
<td style="text-align:left;">
spay_neuterNeutered:boroughQueens
</td>
<td style="text-align:right;">
2.6530410
</td>
<td style="text-align:right;">
0.0670062
</td>
<td style="text-align:right;">
14.5614399
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
2.3279835
</td>
<td style="text-align:right;">
3.0273936
</td>
</tr>
<tr>
<td style="text-align:left;">
spay_neuterNeutered:boroughStaten Island
</td>
<td style="text-align:right;">
2.7436374
</td>
<td style="text-align:right;">
0.0868963
</td>
<td style="text-align:right;">
11.6148176
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
2.3149684
</td>
<td style="text-align:right;">
3.2546430
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="evaluation-1" class="section level3">
<h3>Evaluation</h3>
<p>Additionally, the quality of the fitted model can be assessed through
residual analysis and diagnostics, as illustrated in the following four
plots.</p>
<ul>
<li>Residual vs. Fitted Plot:</li>
</ul>
<p>This graph helps to detect non-linearity, unequal error variances,
and outliers. Ideally, the residuals should be randomly dispersed around
the horizontal axis, meaning the red dashed line (a smooth curve) should
be close to a horizontal straight line.</p>
<ul>
<li>Q-Q Plot:</li>
</ul>
<p>This plot is used to check whether the residuals conform to the
distribution assumed by the model.</p>
<ul>
<li>Scale-Location Plot:</li>
</ul>
<p>This plot shows the spread of residuals versus fitted values and
helps to check for homoscedasticity (constant spread of residuals). A
model that meets this assumption will show a horizontal line with
randomly spread points.</p>
<ul>
<li>Residuals vs. Leverage Plot:</li>
</ul>
<p>This plot is critical for identifying observations with high leverage
values—points that have a significant impact on the model’s fit.
Ideally, no points should exceed the threshold set by Cook’s distance,
indicated by the dashed lines.</p>
<pre class="r"><code>library(DHARMa)
residuals_sim = simulateResiduals(model_stepwise)
plot(model_stepwise)</code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-3-1.png" width="672" /><img src="regression_files/figure-html/unnamed-chunk-3-2.png" width="672" /><img src="regression_files/figure-html/unnamed-chunk-3-3.png" width="672" /><img src="regression_files/figure-html/unnamed-chunk-3-4.png" width="672" /></p>
<p>From the analysis of the four diagnostic plots, the fitted model
exhibits several shortcomings. Firstly, the tails of the residual
distribution slightly deviate from the assumed negative binomial
distribution. This deviation suggests that the residuals might not be
perfectly modeled, indicating potential issues with the model fit or the
distributional assumptions. Secondly, the distribution of points in the
Scale-Location plot appears striated, and the red smooth line shows a
non-horizontal trend. This pattern indicates that the variance of the
residuals may change with fitted values, suggesting the presence of
heteroscedasticity. This non-constant variance can affect the
reliability of the model’s standard errors and confidence
intervals.Lastly, the Residuals vs Leverage Plot reveals the presence of
points with high leverage, which could be overly influencing the model’s
predictions. These high leverage points warrant further investigation to
determine whether they should be removed or adjusted to improve model
accuracy and robustness.</p>
</div>
<div id="prediction" class="section level3">
<h3>Prediction</h3>
<p>Cross-validation of the final model is depicted in the following
illustration, where the red dashed line represents the ideal prediction
scenario (i.e., predicted values equal actual values). If points fall
near this line, it indicates that the model predicts well. Points
located above the diagonal line suggest that the model underestimates
the actual values; conversely, if points are below the diagonal line,
the model overestimates the actual values.</p>
<pre class="r"><code># Predicted vs Actual Bite Count
inter_predict = bites_by_group |&gt; 
  mutate(predicted = predict(model_stepwise, type = &quot;response&quot;))

ggplot(inter_predict, aes(x = predicted, y = bite_count)) +
  geom_point(alpha = 0.5) +
  geom_abline(slope = 1, intercept = 0, color = &quot;red&quot;, linetype = &quot;dashed&quot;) +
  labs(title = &quot;Predicted vs. Actual Bite Count&quot;,
       x = &quot;Predicted Bite Count&quot;,
       y = &quot;Actual Bite Count&quot;) +
  theme_minimal()</code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Overall, while the scatter plot shows a slight systematic deviation,
the final negative binomial regression model still accurately predicts
low and medium value areas. However, the error is larger in high-value
areas, where actual values tend to fall below the predicted values. This
may indicate a tendency of the model to overfit in regions with high
incident counts.</p>
</div>
</div>
<div id="generalized-linear-mixed-model-glmm" class="section level1">
<h1>Generalized Linear Mixed Model (GLMM)</h1>
<p>To address the model fitting issue, a generalized linear mixed model
is employed. The Generalized Linear Mixed Model (GLMM) is an extension
of the Generalized Linear Model (GLM) and the Linear Mixed Model (LMM).
GLMM consists of three main components: random effects, fixed effects,
and a link function. Fixed effects represent the overall level
parameters consistent across all observations, while random effects
account for individual variability or group-level differences that may
influence the response variable. The link function connects the linear
predictor to the mean of the response variable distribution, allowing
the dependent variable to deviate from a normal distribution and
enabling modeling of various types of data, including binary, count, and
continuous outcomes.</p>
<p>Let the response variable <span class="math inline">\(y\)</span>
belongs to the exponential family, its conditional distribution can be
expressed as follows:</p>
<p><span class="math display">\[f(y|b) = \prod\limits_{i = 1}^n
{f({y_i}|{\eta _i})}\]</span></p>
<p>Where <span class="math inline">\({\eta _i} = {x_i}^ \top \beta  +
{z_i}^ \top b\)</span>. Additionally, the random effect <span
class="math inline">\(b\)</span> is assumed to be distributed according
to <span class="math inline">\(b \sim {\rm N}(0,\Sigma )\)</span>.</p>
<p>Therefore the GLMM is structured as follows:</p>
<p><span class="math display">\[g(\vec {\rm E}(y)) = {\rm X}\vec
\beta  + {\rm Z}\vec b + \varepsilon\]</span></p>
<p>In the model, <span class="math inline">\(g( \cdot )\)</span>
represents the link function, which connects the expected value of the
response variable to the linear predictor. Here, the logarithm function
<span class="math inline">\(g(\mu ) = \ln (\mu )\)</span> is used, which
is appropriate for the Poisson distribution. <span
class="math inline">\(\vec{\mathrm{E}}(y)\)</span> denotes the vector of
expected values for the response variable, and <span
class="math inline">\(\varepsilon\)</span> represents the error term,
capturing random noise or the unexplained variance. <span
class="math inline">\({\rm X}\vec \beta  + {\rm Z}\vec b\)</span>
represents the linear combination of fixed and random effects, <span
class="math inline">\({\rm X}\vec \beta\)</span> is used to explain
global trends, and <span class="math inline">\({\rm Z}\vec b\)</span> is
utilized to capture differences among observations. In this context,
<span class="math inline">\({\rm X}\)</span> is the design matrix for
fixed effects, which is of order <span class="math inline">\(n \times
p\)</span>, where <span class="math inline">\(n\)</span> is the number
of observations and <span class="math inline">\(p\)</span> is the number
of fixed effect variables; <span class="math inline">\(\vec
\beta\)</span> is the vector of coefficients for fixed effects, with
each element representing the regression coefficient of a fixed effect
variable. Similarly, <span class="math inline">\({\rm Z}\)</span> also
serves as the design matrix for random effects, of order <span
class="math inline">\(n \times q\)</span>, where <span
class="math inline">\(q\)</span> is the number of random effect
variables. <span class="math inline">\(\vec b\)</span> is the vector of
coefficients for random effects, representing inter-group deviations
used to explain random differences between groups. The model assumes
<span class="math inline">\(b \sim {\rm N}(0,\Sigma )\)</span>, thereby
the random effects are normally distributed with a mean of <span
class="math inline">\(0\)</span> and a covariance matrix <span
class="math inline">\(\Sigma\)</span>.</p>
<p>For the dog bite incidents dataset, the response variable <span
class="math inline">\(y\)</span> represents the number of dog bite
incidents per zipcode per month. Fixed effects in the model include
year, month, gender, and sterilization status. Random effects are
attributed to different boroughs (5 boroughs in total). Thus, for all
response variables, <span class="math inline">\({\rm X}\)</span> is a
matrix containing year, month, gender, and sterilization status; <span
class="math inline">\(\vec \beta\)</span> represents the coefficients
for the fixed effects; <span class="math inline">\({\rm X}\)</span>
indicates the matrix for the borough each response variable belongs to;
and <span class="math inline">\(\vec b\)</span> denotes the deviation
for each borough (random effects). This setup allows the model to adjust
for the influence of both environmental conditions and borough-specific
variations in the occurrence of dog bites.</p>
<div id="results-2" class="section level2">
<h2>Results</h2>
<pre class="r"><code>library(lme4)
glmm_model = glmer.nb(
  bite_count ~ year + month + gender + spay_neuter + (1 | borough), 
  data = bites_by_group
)
summary(glmm_model)

library(broom.mixed)
glmm_model_summary &lt;-
  broom.mixed::tidy(glmm_model) %&gt;%
  mutate(
    significance = case_when(
      p.value &lt; 0.001 ~ &quot;***&quot;,
      p.value &lt; 0.01 ~ &quot;**&quot;,
      p.value &lt; 0.05 ~ &quot;*&quot;,
      TRUE ~ &quot;&quot;
    )
  ) |&gt; 
  dplyr::select(-effect, -group)

kable(
  glmm_model_summary,
  col.names = c(&quot;Term&quot;, &quot;Estimate&quot;, &quot;SE&quot;, &quot;Statistic&quot;, &quot;P-value&quot;, &quot;Significance&quot;),
  caption = &quot;Summary of Negative Binomial Regression Results&quot;
) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;), full_width = TRUE) %&gt;%
  scroll_box(height = &quot;400px&quot;)</code></pre>
<p>Random Effects：</p>
<p><code>Borough</code>: Variance: 0.1297, standard Deviation: 0.3601.
Indicates moderate variability between boroughs in the baseline bite
count.</p>
<p>Fixed Effects:</p>
<ul>
<li><code>Year</code>: 2017 has <em>positive</em> coefficient (0.15336,
p &lt; 0.001), suggesting a higher bite count compared to 2015. While
2020 and 2021 have strong <em>negative</em> coefficients (-0.27884 and
-0.28669, p &lt; 0.001), indicating a substantial reduction in bite
counts. This could relate to external factors like the COVID-19
pandemic.</li>
<li><code>Month</code>: Positive coefficient (0.12734, p = 0.026),
suggesting higher bite counts in April. In May, June and July, all p
&lt; 0.001, maybe there is a seasonal peak during summer.</li>
<li><code>Gender</code>: Male dogs have strong positive coefficient
(0.88482, p &lt; 0.001), indicating male dogs have a significantly
higher bite count compared to female dogs.</li>
<li><code>Spay/Neuter Status</code>: Dogs who are neutered have have
significantly lower bite counts (-0.11231, p &lt; 0.001).</li>
</ul>
</div>
<div id="evaluation-2" class="section level2">
<h2>Evaluation</h2>
<pre class="r"><code>library(DHARMa)
residuals_glmm_sim = simulateResiduals(glmm_model)
plot(residuals_glmm_sim)</code></pre>
<p><img src="regression_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><code>Q-Q Plot</code>:</p>
<ul>
<li>Kolmogorov-Smirnov (KS) Test: p-value = 0.05845: Indicates that the
residual distribution is not significantly different from the expected
distribution (n.s. means not significant). The model fits the overall
data distribution well.</li>
<li>Dispersion Test: p-value = 0.896: Suggests no evidence of
overdispersion or underdispersion in the residuals. This confirms the
appropriateness of using the negative binomial model for handling count
data with dispersion.</li>
<li>Outlier Test: p-value = 0.00056: Indicates significant deviations
due to outliers. This suggests that there are specific data points that
the model fails to fit well.</li>
</ul>
<p><code>Residuals vs. Predicted</code>:</p>
<ul>
<li>The red lines (quantile deviations) highlight significant deviations
at certain ranges of predictions, particularly near the lower predicted
values (around the 0.25 quantile). This indicates a slight mismatch
between the model predictions and observed data for certain ranges.</li>
<li>Despite the overall good fit, systematic patterns (e.g., slight
curvature) in the residuals suggest possible room for improvement in
model specification.</li>
</ul>
</div>
</div>
<div id="model-comparison" class="section level1">
<h1>Model comparison</h1>
<pre class="r"><code>model_comparison &lt;- data.frame(
  Model = c(&quot;model&quot;, &quot;filter_model&quot;, &quot;glmm_model&quot;),
  AIC = c(7403.4, 7045.8, 7428.7),
  Null_Deviance = c(3914.5, 4944.9, NA),
  Residual_Deviance = c(1549.7, 1437.1, 1551),
  Random_Effects = c(&quot;None&quot;, &quot;None&quot;, &quot;Borough&quot;),
  Description = c(
    &quot;Negative binomial regression with main effects only&quot;,
    &quot;Negative binomial regression with main effects and interaction terms&quot;,
    &quot;Negative binomial mixed model with random intercept for Borough&quot;
  )
)

model_comparison %&gt;%
  kbl(
    caption = &quot;Model Comparison Table&quot;,
    align = &quot;lcccccc&quot;,  
    col.names = c(&quot;Model&quot;, &quot;AIC&quot;, &quot;Null Deviance&quot;, 
                  &quot;Residual Deviance&quot;, &quot;Random Effects&quot;, &quot;Description&quot;)
  ) %&gt;%
  kable_styling(
    bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), 
    full_width = TRUE
  ) %&gt;%
  scroll_box(width = &quot;100%&quot;, height = &quot;400px&quot;)</code></pre>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:400px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Model Comparison Table
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Model
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
AIC
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Null Deviance
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Residual Deviance
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Random Effects
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
model
</td>
<td style="text-align:center;">
7403.4
</td>
<td style="text-align:center;">
3914.5
</td>
<td style="text-align:center;">
1549.7
</td>
<td style="text-align:center;">
None
</td>
<td style="text-align:center;">
Negative binomial regression with main effects only
</td>
</tr>
<tr>
<td style="text-align:left;">
filter_model
</td>
<td style="text-align:center;">
7045.8
</td>
<td style="text-align:center;">
4944.9
</td>
<td style="text-align:center;">
1437.1
</td>
<td style="text-align:center;">
None
</td>
<td style="text-align:center;">
Negative binomial regression with main effects and interaction terms
</td>
</tr>
<tr>
<td style="text-align:left;">
glmm_model
</td>
<td style="text-align:center;">
7428.7
</td>
<td style="text-align:center;">
NA
</td>
<td style="text-align:center;">
1551.0
</td>
<td style="text-align:center;">
Borough
</td>
<td style="text-align:center;">
Negative binomial mixed model with random intercept for Borough
</td>
</tr>
</tbody>
</table>
</div>
<p><em>Performance:</em></p>
<p>The <code>filter_model</code> has the lowest AIC and Residual
Deviance, suggesting the best fit among the three. However, its lack of
random effects might overlook some unobserved variability (e.g., between
boroughs).</p>
<p><em>Complexity:</em></p>
<p><code>glmm_model</code> introduces random effects, which makes it
more flexible and suitable for accounting for regional differences, but
this increases its AIC and Residual Deviance slightly.</p>
<p><em>Interpretability:</em></p>
<p><code>model</code> is the simplest and easiest to interpret but
underperforms compared to the other two models.</p>
<p><em>Residual Diagnosis:</em></p>
<p><code>model</code> VS <code>glmm_model</code>: The KS test and
dispersion test results in both models are similar, suggesting both
models handle overall distribution and dispersion well. However, the
outlier test is significant in <code>glmm model</code>, whlie the
outlier test is insignificant in the <code>model</code>, indicating that
this alternative model has difficulty capturing certain extreme values
or specific subsets of the data.</p>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
</div>
</div>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
